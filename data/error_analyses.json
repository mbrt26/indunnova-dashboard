{
  "2d146bee0208": {
    "analysis": "## 1. **Resumen**\nError de importaci\u00f3n en Django donde la clase `Colaborador` no est\u00e1 definida cuando se intenta usar en la l\u00ednea 1162 del archivo `models_original.py`, dentro de la definici\u00f3n de la clase `ComiteProyecto`. Este error impide que la aplicaci\u00f3n inicie correctamente en Google Cloud Run.\n\n## 2. **Causa Probable**\n- La clase `Colaborador` no est\u00e1 definida antes de ser referenciada en la l\u00ednea 1162\n- Posibles causas espec\u00edficas:\n  - `Colaborador` est\u00e1 definida despu\u00e9s de `ComiteProyecto` en el mismo archivo\n  - `Colaborador` no fue importada desde otro m\u00f3dulo\n  - Error tipogr\u00e1fico en el nombre de la clase\n  - La clase fue eliminada o renombrada sin actualizar las referencias\n\n## 3. **Impacto**\n**Nivel: CR\u00cdTICO**\n- La aplicaci\u00f3n no puede iniciar (falla en `django.setup()`)\n- 296 ocurrencias indican fallo sistem\u00e1tico en todos los intentos de inicio\n- Servicio completamente inoperativo en producci\u00f3n\n- Afecta desde el 25 de enero, sugiriendo un despliegue defectuoso\n\n## 4. **Soluci\u00f3n Sugerida**\n```python\n# Opci\u00f3n 1: Si Colaborador est\u00e1 definida m\u00e1s abajo en el archivo\n# Mover la definici\u00f3n de ComiteProyecto despu\u00e9s de Colaborador\n\n# Opci\u00f3n 2: Si Colaborador debe ser importada\nfrom .models_colaborador import Colaborador  # Al inicio del archivo\n\n# Opci\u00f3n 3: Si es una referencia de ForeignKey, usar string\nclass ComiteProyecto(models.Model):\n    colaborador = models.ForeignKey('Colaborador', ...)  # En lugar de Colaborador\n```\n\n**Pasos inmediatos:**\n1. Revisar la l\u00ednea 1162 en `/app/proyectos/models_original.py`\n2. Verificar si `Colaborador` existe y est\u00e1 accesible\n3. Aplicar una de las soluciones anteriores\n4. Ejecutar `python manage.py check` para validar\n5. Redesplegar en Cloud Run\n\n## 5. **Prevenci\u00f3n**\n- Implementar tests de importaci\u00f3n en el pipeline CI/CD\n- Usar `python manage.py check --deploy` antes de cada despliegue\n- Configurar linting que detecte variables no definidas\n- Establecer tests de smoke que verifiquen que la aplicaci\u00f3n inicia correctamente\n- Revisar todas las referencias de modelos en pull requests",
    "analyzed_at": "2026-02-01T06:58:12.060086+00:00"
  },
  "c0172d753507": {
    "analysis": "## An\u00e1lisis del Error - Django en Google Cloud Run\n\n### 1. **Resumen**\nEl servicio Django en Cloud Run est\u00e1 devolviendo errores 503 debido a respuestas HTTP malformadas o fallos de conexi\u00f3n con la instancia. El error persiste por m\u00e1s de una semana con 209 ocurrencias y alta latencia (2.6 segundos).\n\n### 2. **Causa Probable**\n- **Timeout de la aplicaci\u00f3n Django**: La instancia no responde dentro del l\u00edmite de tiempo\n- **Agotamiento de recursos**: CPU/memoria insuficientes causando que el contenedor falle\n- **Error en el health check**: Django no est\u00e1 respondiendo correctamente a las verificaciones\n- **Configuraci\u00f3n incorrecta de WSGI/ASGI**: Servidor web mal configurado\n\n### 3. **Impacto**\n**Nivel: CR\u00cdTICO**\n- Servicio completamente inaccesible para usuarios\n- 209 errores en 7 d\u00edas indica falla sistem\u00e1tica\n- Afecta la disponibilidad del entorno de staging\n- Puede impactar testing y deployment pipeline\n\n### 4. **Soluci\u00f3n Sugerida**\n```bash\n# 1. Revisar logs de la aplicaci\u00f3n\ngcloud logging read \"resource.type=cloud_run_revision AND resource.labels.service_name=rgd-aire-staging\"\n\n# 2. Verificar configuraci\u00f3n de recursos\ngcloud run services describe rgd-aire-staging --region=us-central1\n\n# 3. Ajustar configuraci\u00f3n de Cloud Run\ngcloud run services update rgd-aire-staging \\\n  --memory=1Gi \\\n  --cpu=1 \\\n  --timeout=300 \\\n  --max-instances=10 \\\n  --region=us-central1\n\n# 4. Verificar configuraci\u00f3n Django\n# - DEBUG = False en production\n# - ALLOWED_HOSTS configurado correctamente\n# - Health check endpoint funcionando\n```\n\n### 5. **Prevenci\u00f3n**\n- **Monitoreo**: Configurar alertas para errores 5xx y latencia alta\n- **Health checks**: Implementar endpoint `/health/` en Django\n- **Resource limits**: Definir CPU/memoria adecuados basados en carga\n- **Testing**: Validar deployment en staging antes de producci\u00f3n\n- **Logging**: Configurar logging estructurado para mejor debugging\n\n**Acci\u00f3n inmediata recomendada**: Revisar logs de aplicaci\u00f3n y aumentar recursos del servicio.",
    "analyzed_at": "2026-02-01T06:58:24.132150+00:00"
  },
  "3acc476fc9f4": {
    "analysis": "## An\u00e1lisis del Error Django en Google Cloud Run\n\n### 1. **Resumen**\nLa aplicaci\u00f3n Django no puede inicializar correctamente durante el startup de Gunicorn debido a un `NameError` en el proceso de carga del WSGI. El error ocurre consistentemente durante 148 intentos de despliegue en una semana.\n\n### 2. **Causa Probable**\n- **Variable/m\u00f3dulo no definido**: El archivo `wsgi.py` est\u00e1 intentando usar una variable, funci\u00f3n o m\u00f3dulo que no est\u00e1 definido o no ha sido importado correctamente\n- **Configuraci\u00f3n de Django incompleta**: Falta la configuraci\u00f3n de `DJANGO_SETTINGS_MODULE` o hay un error en la importaci\u00f3n de settings\n- **Dependencia faltante**: Alg\u00fan paquete requerido no est\u00e1 instalado en el contenedor de Cloud Run\n\n### 3. **Impacto**\n**Nivel: CR\u00cdTICO**\n- La aplicaci\u00f3n no puede iniciarse, resultando en 100% de downtime\n- 148 fallos en 7 d\u00edas indica un problema sistem\u00e1tico que impide cualquier funcionalidad\n- Los usuarios no pueden acceder al servicio\n\n### 4. **Soluci\u00f3n Sugerida**\n\n1. **Revisar `/app/rgd_aire/wsgi.py` l\u00ednea 21:**\n   ```python\n   # Verificar que todas las importaciones est\u00e9n presentes\n   import os\n   from django.core.wsgi import get_wsgi_application\n   \n   # Asegurar que settings est\u00e9 configurado\n   os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'rgd_aire.settings')\n   application = get_wsgi_application()\n   ```\n\n2. **Verificar variables de entorno en Cloud Run:**\n   ```bash\n   DJANGO_SETTINGS_MODULE=rgd_aire.settings\n   PYTHONPATH=/app\n   ```\n\n3. **Revisar Dockerfile:**\n   - Confirmar que todas las dependencias est\u00e1n en `requirements.txt`\n   - Verificar que el `WORKDIR` y `PYTHONPATH` est\u00e9n correctos\n\n4. **Debugging local:**\n   ```bash\n   python manage.py check --deploy\n   python -c \"from rgd_aire.wsgi import application\"\n   ```\n\n### 5. **Prevenci\u00f3n**\n\n1. **Tests automatizados:**\n   - Incluir test de importaci\u00f3n WSGI en CI/CD\n   - Validar configuraci\u00f3n de Django antes del deploy\n\n2. **Monitoreo mejorado:**\n   - Logs m\u00e1s detallados en el startup\n   - Health checks que verifiquen la inicializaci\u00f3n completa\n\n3. **Proceso de deploy:**\n   - Staging environment que replique exactamente producci\u00f3n\n   - Rollback autom\u00e1tico si el servicio no pasa health checks",
    "analyzed_at": "2026-02-01T06:58:36.997909+00:00"
  },
  "246f30992dfd": {
    "analysis": "## An\u00e1lisis de Error - IntegrityError en Django\n\n### 1. **Resumen**\nLa aplicaci\u00f3n Django est\u00e1 experimentando errores de integridad de base de datos (IntegrityError) que se han repetido 91 veces en 5 d\u00edas. Aunque el traceback est\u00e1 truncado, este tipo de error t\u00edpicamente indica violaciones de restricciones de base de datos.\n\n### 2. **Causa Probable**\n- **Violaci\u00f3n de restricciones UNIQUE**: Intentos de insertar registros con valores duplicados en campos \u00fanicos\n- **Violaci\u00f3n de claves for\u00e1neas**: Referencias a registros que no existen\n- **Campos NOT NULL**: Intentos de insertar datos sin valores requeridos\n- **Condiciones de carrera**: M\u00faltiples procesos intentando crear el mismo registro simult\u00e1neamente\n\n### 3. **Impacto**\n**Nivel: ALTO**\n- **Frecuencia**: 91 ocurrencias en 5 d\u00edas indica un problema sistem\u00e1tico\n- **Funcionalidad**: Los usuarios no pueden completar operaciones de creaci\u00f3n/actualizaci\u00f3n\n- **Datos**: P\u00e9rdida potencial de informaci\u00f3n de proveedores\n- **Experiencia de usuario**: Errores 500 visibles para los usuarios\n\n### 4. **Soluci\u00f3n Sugerida**\n\n**Inmediato:**\n```python\n# 1. Implementar manejo de excepciones\ntry:\n    proveedor.save()\nexcept IntegrityError as e:\n    # Log espec\u00edfico del error\n    logger.error(f\"IntegrityError: {e}\")\n    # Manejar seg\u00fan el tipo de violaci\u00f3n\n```\n\n**A corto plazo:**\n- Revisar logs completos para identificar el modelo y campo espec\u00edfico\n- Implementar validaci\u00f3n en formularios antes de guardar\n- Usar `get_or_create()` para evitar duplicados\n- A\u00f1adir transacciones at\u00f3micas en operaciones cr\u00edticas\n\n**Consultas de diagn\u00f3stico:**\n```sql\n-- Buscar duplicados en campos \u00fanicos\nSELECT campo_unico, COUNT(*) FROM tabla_proveedor \nGROUP BY campo_unico HAVING COUNT(*) > 1;\n```\n\n### 5. **Prevenci\u00f3n**\n- **Validaci\u00f3n robusta**: Implementar validaci\u00f3n en modelo, formulario y vista\n- **Constraints de DB**: Definir \u00edndices \u00fanicos apropiados en el modelo Django\n- **Testing**: Casos de prueba para escenarios de duplicaci\u00f3n\n- **Monitoreo**: Alertas espec\u00edficas para IntegrityError\n- **Transacciones**: Usar `@transaction.atomic` en operaciones complejas\n\n**Prioridad**: Resolver inmediatamente - Este error est\u00e1 impactando la funcionalidad principal del sistema de gesti\u00f3n de proveedores.",
    "analyzed_at": "2026-02-01T06:58:49.874025+00:00"
  },
  "dde6c375e4f9": {
    "analysis": "## An\u00e1lisis del Error - Django en Google Cloud Run\n\n### 1. **Resumen**\nError HTTP 500 en el endpoint `/notificaciones/no-leidas/` con latencia extremadamente alta (11.4 segundos). El error se ha repetido 91 veces en 5 d\u00edas, indicando un problema sistem\u00e1tico en el servicio de notificaciones.\n\n### 2. **Causa Probable**\n- **Timeout de base de datos**: Consulta SQL lenta o bloqueos en la tabla de notificaciones\n- **Consulta ineficiente**: Falta de \u00edndices en campos filtrados (usuario, fecha, estado le\u00eddo)\n- **N+1 queries**: M\u00faltiples consultas no optimizadas para obtener notificaciones relacionadas\n- **Conexi\u00f3n de BD agotada**: Pool de conexiones saturado en Cloud SQL\n\n### 3. **Impacto**\n**Nivel: ALTO**\n- Afecta funcionalidad cr\u00edtica de notificaciones en tiempo real\n- Latencia de 11+ segundos genera timeout y mala experiencia de usuario\n- 91 ocurrencias indican que m\u00faltiples usuarios est\u00e1n afectados\n- Puede saturar recursos de Cloud Run y generar costos adicionales\n\n### 4. **Soluci\u00f3n Sugerida**\n```python\n# 1. Optimizar la consulta Django\ndef obtener_notificaciones_no_leidas(request):\n    notificaciones = Notificacion.objects.select_related(\n        'remitente', 'tipo'\n    ).filter(\n        destinatario=request.user,\n        leida=False\n    ).order_by('-fecha_creacion')[:50]  # Limitar resultados\n```\n\n**Acciones inmediatas:**\n- Revisar logs detallados de Django (`DEBUG=True` temporalmente)\n- Agregar \u00edndice compuesto: `['destinatario', 'leida', 'fecha_creacion']`\n- Implementar paginaci\u00f3n y cach\u00e9 Redis para notificaciones\n- Aumentar timeout de Cloud Run a 30s temporalmente\n\n### 5. **Prevenci\u00f3n**\n- **Monitoreo**: Configurar alertas para queries >2 segundos\n- **Performance**: Implementar Django Debug Toolbar en desarrollo\n- **Cach\u00e9**: Redis para notificaciones frecuentemente consultadas\n- **Testing**: Pruebas de carga en endpoints cr\u00edticos\n- **Database**: Query optimization regular y EXPLAIN ANALYZE mensual",
    "analyzed_at": "2026-02-01T06:59:01.940084+00:00"
  },
  "b859899768a4": {
    "analysis": "## An\u00e1lisis de Error: OperationalError en Django + Cloud Run\n\n### 1. **Resumen**\nLa aplicaci\u00f3n Django no puede conectarse a la base de datos PostgreSQL en Google Cloud SQL debido a un fallo de autenticaci\u00f3n. El usuario \"postgres\" est\u00e1 siendo rechazado por credenciales incorrectas.\n\n### 2. **Causa Probable**\n- **Contrase\u00f1a incorrecta**: La contrase\u00f1a del usuario \"postgres\" en la configuraci\u00f3n de Django no coincide con la establecida en Cloud SQL\n- **Credenciales desactualizadas**: Posible rotaci\u00f3n de contrase\u00f1as no reflejada en variables de entorno\n- **Configuraci\u00f3n err\u00f3nea**: Variables de entorno mal configuradas en Cloud Run\n\n### 3. **Impacto**\n**CR\u00cdTICO** - La aplicaci\u00f3n no puede acceder a la base de datos, resultando en:\n- Servicio completamente inoperativo (80 ocurrencias en ~20 horas)\n- P\u00e9rdida total de funcionalidad para usuarios\n- Posible p\u00e9rdida de transacciones y datos\n\n### 4. **Soluci\u00f3n Sugerida**\n```bash\n# 1. Verificar contrase\u00f1a actual en Cloud SQL\ngcloud sql users describe postgres --instance=postgres-consolidated\n\n# 2. Actualizar contrase\u00f1a si es necesario\ngcloud sql users set-password postgres \\\n  --instance=postgres-consolidated \\\n  --password=[NUEVA_CONTRASE\u00d1A]\n\n# 3. Verificar/actualizar variables de entorno en Cloud Run\ngcloud run services describe gestion-proveedores-isa \\\n  --region=us-central1 --format=\"value(spec.template.spec.template.spec.containers[0].env)\"\n\n# 4. Redesplegar con credenciales correctas\ngcloud run deploy gestion-proveedores-isa \\\n  --set-env-vars=\"DB_PASSWORD=[CONTRASE\u00d1A_CORRECTA]\"\n```\n\n### 5. **Prevenci\u00f3n**\n- **Secret Manager**: Migrar credenciales a Google Secret Manager en lugar de variables de entorno\n- **Monitoreo**: Implementar alertas de conexi\u00f3n DB en Cloud Monitoring\n- **Documentaci\u00f3n**: Mantener registro actualizado de credenciales y procedimientos de rotaci\u00f3n\n- **Testing**: Validar conexiones DB en pipeline CI/CD antes del deployment",
    "analyzed_at": "2026-02-01T06:59:12.258316+00:00"
  },
  "cdc7cf45e223": {
    "analysis": "## An\u00e1lisis del Error - Django SessionStore en Google Cloud Run\n\n### 1. **Resumen**\nError en el sistema de sesiones de Django donde el objeto `SessionStore` no tiene el atributo `_session_cache`. Esto indica un problema de inicializaci\u00f3n o corrupci\u00f3n en el manejo de sesiones del framework.\n\n### 2. **Causa Probable**\n- **Incompatibilidad de versiones**: Mismatch entre versi\u00f3n de Django y dependencias relacionadas con sesiones\n- **Problema de concurrencia**: Multiple workers en Cloud Run accediendo simult\u00e1neamente al mismo objeto de sesi\u00f3n\n- **Inicializaci\u00f3n incompleta**: El objeto SessionStore no se est\u00e1 inicializando correctamente\n- **Cache corrupto**: Problema con el backend de cache configurado para sesiones\n\n### 3. **Impacto**\n**Nivel: ALTO**\n- Afecta la funcionalidad de autenticaci\u00f3n y manejo de estado de usuarios\n- 73 ocurrencias indican un problema sistem\u00e1tico, no aislado\n- Usuarios pueden perder sesiones activas o no poder iniciar sesi\u00f3n\n- Compromete la experiencia de usuario en funciones cr\u00edticas\n\n### 4. **Soluci\u00f3n Sugerida**\n\n```python\n# 1. Verificar configuraci\u00f3n de sesiones en settings.py\nSESSION_ENGINE = 'django.contrib.sessions.backends.db'  # o 'cache' si usas Redis/Memcache\nSESSION_COOKIE_AGE = 1209600  # 2 semanas\nSESSION_SAVE_EVERY_REQUEST = True\n\n# 2. Si usas cache, verificar configuraci\u00f3n:\nCACHES = {\n    'default': {\n        'BACKEND': 'django.core.cache.backends.redis.RedisCache',\n        'LOCATION': 'redis://your-redis-url:6379/1',\n        'OPTIONS': {\n            'CONNECTION_POOL_KWARGS': {\n                'max_connections': 50,\n                'retry_on_timeout': True,\n            }\n        }\n    }\n}\n```\n\n**Pasos inmediatos:**\n1. Actualizar Django a versi\u00f3n LTS m\u00e1s reciente\n2. Verificar compatibilidad de todas las dependencias\n3. Implementar manejo de excepciones para sesiones:\n\n```python\n# En views.py o middleware personalizado\ntry:\n    session_data = request.session.get('key')\nexcept AttributeError:\n    # Recrear sesi\u00f3n\n    request.session.flush()\n    request.session.create()\n```\n\n4. Configurar Cloud Run con variables de entorno adecuadas para sesiones\n\n### 5. **Prevenci\u00f3n**\n\n- **Testing**: Implementar pruebas espec\u00edficas para manejo de sesiones en entorno de producci\u00f3n\n- **Monitoreo**: Configurar alertas para errores de SessionStore\n- **Versionado**: Fijar versiones exactas de Django y dependencias en `requirements.txt`\n- **Configuraci\u00f3n Cloud Run**: \n  - Configurar correctamente `--max-instances` y `--concurrency`\n  - Usar Redis/Cloud SQL para sesiones persistentes en lugar de memoria local\n- **Health checks**: Implementar endpoints que verifiquen el estado del sistema de sesiones",
    "analyzed_at": "2026-02-01T06:59:28.027074+00:00"
  },
  "8b60a2c2fc9f": {
    "analysis": "## **AN\u00c1LISIS DEL ERROR**\n\n### 1. **Resumen**\nError HTTP 500 (Internal Server Error) en la ruta `/produccion/ordenes/nueva/` de la aplicaci\u00f3n Django desplegada en Cloud Run. El error ha ocurrido 38 veces durante 4 d\u00edas, con una latencia elevada de ~2.7 segundos, indicando un problema del lado del servidor.\n\n### 2. **Causa Probable**\n- **Error de aplicaci\u00f3n Django** en la vista que maneja la creaci\u00f3n de nuevas \u00f3rdenes de producci\u00f3n\n- **Problema de base de datos**: timeout, conexi\u00f3n perdida, o constraint violations\n- **Falta de recursos**: memoria insuficiente o CPU sobrecargada en Cloud Run\n- **Variables de entorno faltantes** o mal configuradas\n- **Error en migraciones** o modelo de datos inconsistente\n\n### 3. **Impacto**\n**NIVEL: ALTO**\n- Funcionalidad cr\u00edtica de producci\u00f3n completamente inaccesible\n- 38 fallos en 4 d\u00edas indica problema persistente\n- Afecta flujo de trabajo de creaci\u00f3n de \u00f3rdenes\n- Experiencia de usuario degradada con latencia alta\n\n### 4. **Soluci\u00f3n Sugerida**\n\n**INMEDIATO:**\n```bash\n# 1. Revisar logs detallados\ngcloud logging read \"resource.type=cloud_run_revision AND resource.labels.service_name=plasticos-ambientales\" --limit=50\n\n# 2. Verificar m\u00e9tricas de recursos\ngcloud run services describe plasticos-ambientales --region=us-central1\n```\n\n**PASOS DE DIAGN\u00d3STICO:**\n1. **Habilitar DEBUG logging** en Django settings\n2. **Revisar la vista** `/produccion/ordenes/nueva/` en el c\u00f3digo\n3. **Verificar conexi\u00f3n a base de datos** y migrations\n4. **Aumentar recursos temporalmente** (CPU/Memory en Cloud Run)\n5. **Revisar variables de entorno** y configuraci\u00f3n\n\n### 5. **Prevenci\u00f3n**\n\n**MONITOREO:**\n- Implementar **health checks** espec\u00edficos para esta ruta\n- Configurar **alertas proactivas** en Cloud Monitoring\n- **Logging estructurado** con niveles INFO/ERROR apropiados\n\n**C\u00d3DIGO:**\n```python\n# Agregar manejo de excepciones\ntry:\n    # l\u00f3gica de creaci\u00f3n de orden\nexcept DatabaseError as e:\n    logger.error(f\"DB Error en orden nueva: {e}\")\n    return HttpResponse(\"Error temporal\", status=503)\n```\n\n**INFRAESTRUCTURA:**\n- **Auto-scaling** configurado apropiadamente\n- **Connection pooling** para base de datos\n- **Circuit breakers** para dependencias externas",
    "analyzed_at": "2026-02-01T06:59:41.555948+00:00"
  },
  "7094027ff185": {
    "analysis": "## An\u00e1lisis del Error\n\n### 1. **Resumen**\nError 500 (Internal Server Error) en el endpoint de login de la aplicaci\u00f3n Django, ocurriendo 36 veces en 5 d\u00edas. El mensaje de error est\u00e1 vac\u00edo, lo que indica un problema en el logging o manejo de excepciones.\n\n### 2. **Causa Probable**\n- **Excepci\u00f3n no capturada** en el proceso de autenticaci\u00f3n\n- **Problema de configuraci\u00f3n** de base de datos o servicios externos\n- **Error en el c\u00f3digo** del view de login sin logging adecuado\n- **Timeout de conexi\u00f3n** a servicios dependientes (base de datos, cache, APIs externas)\n- **Configuraci\u00f3n incorrecta** de variables de entorno en Cloud Run\n\n### 3. **Impacto**\n**Nivel: CR\u00cdTICO**\n- Afecta funcionalidad core (autenticaci\u00f3n)\n- 36 ocurrencias indican problema recurrente\n- Usuarios no pueden acceder al sistema\n- P\u00e9rdida potencial de clientes/ventas\n\n### 4. **Soluci\u00f3n Sugerida**\n\n**Inmediato:**\n```python\n# 1. Revisar logs detallados en Cloud Run\ngcloud logging read \"resource.type=cloud_run_revision AND resource.labels.service_name=carnesdelsebastian\" --limit=50\n\n# 2. Mejorar logging en views.py\nimport logging\nlogger = logging.getLogger(__name__)\n\ndef login_view(request):\n    try:\n        # c\u00f3digo de login\n    except Exception as e:\n        logger.error(f\"Login error: {str(e)}\", exc_info=True)\n        return JsonResponse({'error': 'Login failed'}, status=500)\n```\n\n**A corto plazo:**\n- Verificar conectividad a base de datos\n- Revisar variables de entorno (`DATABASE_URL`, `SECRET_KEY`)\n- Implementar health checks\n- A\u00f1adir monitoreo de performance\n\n### 5. **Prevenci\u00f3n**\n\n```python\n# 1. Middleware de error handling\nclass ErrorHandlingMiddleware:\n    def process_exception(self, request, exception):\n        logger.error(f\"Unhandled exception: {exception}\", exc_info=True)\n\n# 2. Settings para logging\nLOGGING = {\n    'version': 1,\n    'handlers': {\n        'console': {\n            'class': 'logging.StreamHandler',\n            'formatter': 'verbose',\n        },\n    },\n    'loggers': {\n        'django': {\n            'handlers': ['console'],\n            'level': 'INFO',\n        },\n    },\n}\n\n# 3. Health check endpoint\ndef health_check(request):\n    return JsonResponse({'status': 'healthy'})\n```\n\n**Monitoreo:**\n- Configurar alertas en Google Cloud Monitoring\n- Implementar circuit breakers para servicios externos\n- Tests automatizados para endpoints cr\u00edticos",
    "analyzed_at": "2026-02-01T06:59:54.456566+00:00"
  },
  "4711160f70ba": {
    "analysis": "## An\u00e1lisis del Error Django FieldError\n\n### 1. **Resumen**\nError `FieldError` en Django que ocurre durante la resoluci\u00f3n de una anotaci\u00f3n con `Avg()` en un QuerySet. El error se produce en el m\u00e9todo `get_datos_ano` al intentar calcular el promedio de un campo que no existe o no es accesible en el modelo.\n\n### 2. **Causa Probable**\n- El campo `campo_hist` usado en `Avg(campo_hist)` no existe en el modelo de la base de datos\n- El campo existe pero tiene un nombre incorrecto (typo o cambio de nomenclatura)\n- El campo no es compatible con operaciones de agregaci\u00f3n (ej: campo de texto en lugar de num\u00e9rico)\n- Posible migraci\u00f3n de base de datos pendiente o inconsistencia entre modelo y esquema\n\n### 3. **Impacto**\n**Nivel: ALTO**\n- 35 ocurrencias en 5 d\u00edas indica un problema frecuente\n- Afecta reportes de producci\u00f3n (funcionalidad cr\u00edtica del negocio)\n- Bloquea completamente la vista cuando se accede a datos hist\u00f3ricos\n- Puede impactar decisiones operativas al no mostrar m\u00e9tricas\n\n### 4. **Soluci\u00f3n Sugerida**\n\n**Inmediato:**\n```python\n# En views_produccion.py l\u00ednea ~331\n# Verificar que el campo existe antes de usarlo\ntry:\n    for registro in qs_hist.values('mes').annotate(valor=Avg(campo_hist)):\n        # procesamiento\nexcept FieldError as e:\n    # Log del error y campo alternativo o valor por defecto\n    logger.error(f\"Campo no encontrado: {campo_hist}\")\n    # Usar campo alternativo o retornar datos vac\u00edos\n```\n\n**Definitivo:**\n1. Verificar el modelo y confirmar nombre correcto del campo\n2. Ejecutar `python manage.py makemigrations` y `python manage.py migrate`\n3. Validar que `campo_hist` sea un campo num\u00e9rico (IntegerField, FloatField, DecimalField)\n\n### 5. **Prevenci\u00f3n**\n- Implementar validaci\u00f3n de campos antes de queries de agregaci\u00f3n\n- Agregar tests unitarios para m\u00e9todos de reportes con datos hist\u00f3ricos\n- Usar `hasattr()` o `getattr()` para verificar existencia de campos din\u00e1micos\n- Establecer process de code review para cambios en modelos de datos\n- Monitoring de errores con alertas autom\u00e1ticas para `FieldError`",
    "analyzed_at": "2026-02-01T07:00:07.636275+00:00"
  }
}